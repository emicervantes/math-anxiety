---
title: "Math Anxiety Initial Modeling"
author: "Emi"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Packages

```{r}
library(lavaan)
library(semPlot)
library(OpenMx)
library(tidyverse)
library(knitr)
library(kableExtra)
library(GGally)
```

# Load clean data

```{r}
df <- read.csv("../../data/clean2.csv")
df <- df %>% 
        mutate( mw_avg = rowMeans(df[6:7], na.rm = TRUE))
head(df)
glimpse(df)
```

# Modeling

1.    Normal regression model: Simple regression model

2.    Path Analysis

For each model, we are using same dependent variable and list of independent variables:

**Dependent variable: **Mathematical anxiety `tma`

**Independent variables: **Gender (`gender`), worked example (`cond`), mind wandering (`mw1`, `mw2`), understanding (`under_avg`), high order thinking (`HOT`), situational interest (`si_sum`)

# Path Analysis

```{r}
# define model
model <- 'tma ~ cond + mw_avg + si_sum + under_avg + HOT + gender'
```
```{r}
# fit the model
fit <- sem(model, data = df)
summary(fit)
```

```{r}
semPaths(fit, 'std', layout = 'circle')
```


